# synthetic_leaves
A repository for data and code for the manuscript "A high resolution model of the grapevine leaf morphospace predicts synthetic leaves"

The `data` folder is included as a zipped file.

![alt text](https://github.com/DanChitwood/synthetic_leaves/blob/main/Figure1.png)
**Figure 1: Procrustes analysis.** A) Generalized Procrustes Analysis mean leaf. Vein identities are indicated by color. Lowercase letters indicate vein tip landmarks and numbers indicate internal vein landmarks. The numbers indicate the order the internal landmarks were detected for one side of the leaf. B) Negative, linear, allometric relationship between the natural log of the ratio of vein to blade area as a function of the natural log of leaf area. Data categories are indicated by color. C) Histogram showing the average Procrustes distance of each leaf to every other leaf. Color indicates data categories. Note that border leaves, which were purposely chosen as lying far from the center of data, have higher average Procrustes distances than other leaf types. D) The average Euclidean distance of each point to its counterpart between leaf halves superimposed using Procrustes analysis. E) The actual mean and a distribution of 1000 bootstrap simulations of the Procrustes distance of each leaf half to its counterpart. F) The average Eulcidean distance of each point to its counterpart between leaf pairs from 20 varieties. G) The actual mean and a distribution of 1000 bootstrap simulations of the Procrustes distance of each leaf to its counterpart for the 20 pairs.

![alt text](https://github.com/DanChitwood/synthetic_leaves/blob/main/Figure2.png)
**Figure 2: Leaf trace data.** Original trace data for each leaf. Vein identities are indicated by color and 1 cm scale bar is provided. Leaves are arranged by data category, left-to-right, top-to-bottom. Species or variety name is indicated. A) V. vinifera and Vitis spp. leaves. B) Border leaves. C-L) Developmental series leaves. Leaves are grouped in fours counting from the growing tip: node 1, node 2, node 3, and node 4. Developmental series for 10 species were measured: C) V. cinerea, D) V. rupestris, E) V. riparia, F) V. labrusca, G) V. acerifolia, H) V. amurensis, I) V. vulpina, J) V. aestivalis, K) V. coignetiae, and L) V. palmata.

![alt text](https://github.com/DanChitwood/synthetic_leaves/blob/main/Figure3.png)
**Figure 3: Leaf trace data.** Original trace data for each leaf. Vein identities are indicated by color and 1 cm scale bar is provided. Leaves are arranged by data category, left-to-right, top-to-bottom. Species or variety name is indicated. A) Leaves traced by Michigan State University students and B) leaves traced by University of California at Davis students. 

![alt text](https://github.com/DanChitwood/synthetic_leaves/blob/main/Figure4.png)
**Figure 4: Morphospace.** A) Continuous models of leaf development for 10 Vitis spp. From node 1 to node 4 counting from the growing tip, 100 leaves were modeled, for which 10 equally spaced indices are shown. B) Eigenleaf representations at -2, -1, 0, +1, and +2 standard deviations and percent variance explained for the first 9 principal components. C) Morphospace onto which data colored by genotype is projected. D) Morphospace onto which data colored by developmental stage is projected. Developmental models for 10 species, which are not included in the calculation of the morphospace, are projected onto it as curves, indicated by color. Values of the natural log of the ratio of vein to blade area are consistent between panels and figures, as indicated.

![alt text](https://github.com/DanChitwood/synthetic_leaves/blob/main/Figure5.png)
**Figure 5: Linear Discriminant Analysis (LDA) model by genotype.** A) Generalized Procrustes Analysis mean leaves by genotype levels, indicated by color and text: V. vinifera, Rootstock, Vitis spp., and Dissected. B) Confusion matrix plotting actual by predicted categories with numbers of each class and indicated by color. C) Data colored by genotype projected onto a plot of LD2 vs. LD1 and D) LD3 vs. LD2. E) Principal Component Analysis (PCA) morphospace. Eigenleaf representations are colored by genotype prediction using the LDA classifier. Data is plotted and bounded by a convex hull.

![alt text](https://github.com/DanChitwood/synthetic_leaves/blob/main/Figure6.png)
**Figure 6: LDA model by developmental stage.** A) Generalized Procrustes Analysis mean leaves by developmental stage, indicated by color and text: node 1, node 2, node 3, node 4, and mature. B) Confusion matrix plotting actual by predicted categories with numbers of each class and indicated by color. C) Data colored by developmental stage and projected onto a plot of LD2 vs. LD1 and D) LD4 vs. LD3. Continuous developmental models for 10 species from node 1 to node 4 and their predicted developmental stage are indicated by smaller points. E) PCA morphospace. Eigenleaf representations are colored by developmental stage prediction using the LDA classifier. Data is plotted and bounded by a convex hull.

![alt text](https://github.com/DanChitwood/synthetic_leaves/blob/main/Figure7.png)
**Figure 7: Synthetic leaves.** Using the inverse transform of the morphospace on uniform sampling of a convex hull of the data calculated using the first nine principal components, 500 synthetic leaves are shown. Vasculature is colored by the natural log of the vein to blade area ratio as indicated.
